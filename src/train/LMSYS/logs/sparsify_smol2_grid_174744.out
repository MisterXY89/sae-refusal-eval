#####################################################
### Starting Set of Runs for MAX_EX = 6557946 (419M tokens) ###
#####################################################
=====================================================
    Starting Run: Factor=8, Tokens=419M
=====================================================
W0619 16:39:42.812000 1748674 site-packages/torch/distributed/run.py:792] 
W0619 16:39:42.812000 1748674 site-packages/torch/distributed/run.py:792] *****************************************
W0619 16:39:42.812000 1748674 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0619 16:39:42.812000 1748674 site-packages/torch/distributed/run.py:792] *****************************************
Using DDP across 2 GPUs.
Map (num_proc=18):   0%|          | 0/777453 [00:00<?, ? examples/s]Map (num_proc=18):   0%|          | 2048/777453 [00:04<28:58, 445.99 examples/s]Map (num_proc=18):   1%|          | 4096/777453 [00:06<19:08, 673.33 examples/s]Map (num_proc=18):   1%|          | 6144/777453 [00:06<10:51, 1184.05 examples/s]Map (num_proc=18):   1%|          | 8192/777453 [00:07<07:18, 1755.13 examples/s]Map (num_proc=18):   1%|▏         | 10240/777453 [00:09<10:26, 1223.93 examples/s]Map (num_proc=18):   2%|▏         | 12288/777453 [00:09<07:19, 1742.65 examples/s]Map (num_proc=18):   2%|▏         | 18432/777453 [00:10<04:21, 2900.46 examples/s]Map (num_proc=18):   3%|▎         | 22528/777453 [00:11<03:37, 3472.28 examples/s]Map (num_proc=18):   3%|▎         | 24576/777453 [00:12<03:51, 3248.91 examples/s]Map (num_proc=18):   3%|▎         | 26624/777453 [00:12<03:18, 3773.39 examples/s]Map (num_proc=18):   4%|▎         | 28672/777453 [00:13<03:59, 3121.27 examples/s]Map (num_proc=18):   4%|▍         | 30720/777453 [00:14<04:07, 3012.82 examples/s]Map (num_proc=18):   4%|▍         | 32768/777453 [00:14<03:14, 3827.59 examples/s]Map (num_proc=18):   4%|▍         | 34816/777453 [00:15<03:10, 3895.67 examples/s]Map (num_proc=18):   5%|▌         | 38912/777453 [00:16<04:05, 3005.99 examples/s]Map (num_proc=18):   5%|▌         | 40960/777453 [00:18<04:43, 2594.86 examples/s]Map (num_proc=18):   6%|▌         | 43008/777453 [00:18<04:33, 2687.97 examples/s]Map (num_proc=18):   6%|▌         | 45056/777453 [00:19<03:47, 3224.04 examples/s]Map (num_proc=18):   6%|▌         | 47104/777453 [00:19<03:23, 3595.84 examples/s]Map (num_proc=18):   6%|▋         | 49152/777453 [00:20<04:05, 2970.72 examples/s]Map (num_proc=18):   7%|▋         | 51200/777453 [00:20<03:23, 3576.65 examples/s]Map (num_proc=18):   7%|▋         | 53248/777453 [00:22<05:08, 2346.35 examples/s]Map (num_proc=18):   7%|▋         | 57344/777453 [00:22<03:31, 3398.47 examples/s]Map (num_proc=18):   8%|▊         | 59392/777453 [00:24<04:26, 2696.09 examples/s]Map (num_proc=18):   8%|▊         | 61440/777453 [00:24<04:07, 2889.37 examples/s]Map (num_proc=18):   8%|▊         | 63488/777453 [00:26<05:11, 2290.60 examples/s]Map (num_proc=18):   8%|▊         | 65536/777453 [00:26<04:58, 2383.49 examples/s]Map (num_proc=18):   9%|▊         | 67584/777453 [00:27<03:56, 3005.00 examples/s]Map (num_proc=18):   9%|▉         | 69632/777453 [00:27<04:03, 2904.28 examples/s]Map (num_proc=18):   9%|▉         | 71680/777453 [00:28<03:17, 3565.76 examples/s]Map (num_proc=18):  10%|▉         | 75776/777453 [00:28<02:35, 4503.10 examples/s]Map (num_proc=18):  10%|█         | 77824/777453 [00:30<04:16, 2732.22 examples/s]Map (num_proc=18):  10%|█         | 79872/777453 [00:30<03:33, 3261.66 examples/s]Map (num_proc=18):  11%|█         | 83968/777453 [00:32<03:50, 3009.93 examples/s]Map (num_proc=18):  11%|█         | 86016/777453 [00:32<03:17, 3503.02 examples/s]Map (num_proc=18):  11%|█▏        | 88064/777453 [00:32<02:43, 4223.67 examples/s]Map (num_proc=18):  12%|█▏        | 90112/777453 [00:32<02:12, 5174.33 examples/s]Map (num_proc=18):  12%|█▏        | 92160/777453 [00:33<02:17, 4987.67 examples/s]Map (num_proc=18):  12%|█▏        | 94208/777453 [00:33<02:30, 4544.40 examples/s]Map (num_proc=18):  12%|█▏        | 96256/777453 [00:34<03:13, 3529.35 examples/s]Map (num_proc=18):  13%|█▎        | 98304/777453 [00:35<03:07, 3621.44 examples/s]Map (num_proc=18):  13%|█▎        | 100352/777453 [00:36<04:08, 2726.95 examples/s]Map (num_proc=18):  13%|█▎        | 104448/777453 [00:36<02:43, 4121.33 examples/s]Map (num_proc=18):  14%|█▎        | 106496/777453 [00:37<03:18, 3384.76 examples/s]Map (num_proc=18):  14%|█▍        | 108544/777453 [00:37<02:47, 3998.64 examples/s]Map (num_proc=18):  14%|█▍        | 110592/777453 [00:38<02:31, 4402.20 examples/s]Map (num_proc=18):  14%|█▍        | 112640/777453 [00:38<02:15, 4904.00 examples/s]Map (num_proc=18):  15%|█▍        | 114688/777453 [00:39<02:37, 4201.60 examples/s]Map (num_proc=18):  15%|█▌        | 116736/777453 [00:40<03:25, 3220.37 examples/s]Map (num_proc=18):  15%|█▌        | 118784/777453 [00:41<04:56, 2221.13 examples/s]Map (num_proc=18):  16%|█▌        | 122880/777453 [00:42<03:26, 3171.70 examples/s]Map (num_proc=18):  16%|█▌        | 124928/777453 [00:42<02:55, 3724.82 examples/s]Map (num_proc=18):  17%|█▋        | 129024/777453 [00:43<02:08, 5059.39 examples/s]Map (num_proc=18):  17%|█▋        | 131072/777453 [00:44<03:25, 3149.19 examples/s]Map (num_proc=18):  17%|█▋        | 133120/777453 [00:45<03:16, 3276.99 examples/s]Map (num_proc=18):  17%|█▋        | 135168/777453 [00:45<02:43, 3932.03 examples/s]Map (num_proc=18):  18%|█▊        | 137216/777453 [00:45<02:36, 4095.40 examples/s]Map (num_proc=18):  18%|█▊        | 143360/777453 [00:46<01:29, 7115.00 examples/s]Map (num_proc=18):  19%|█▊        | 145408/777453 [00:47<02:47, 3765.24 examples/s]Map (num_proc=18):  19%|█▉        | 147456/777453 [00:47<02:28, 4243.43 examples/s]Map (num_proc=18):  19%|█▉        | 149504/777453 [00:48<02:58, 3510.34 examples/s]Map (num_proc=18):  19%|█▉        | 151552/777453 [00:49<03:40, 2836.24 examples/s]Map (num_proc=18):  20%|█▉        | 153600/777453 [00:52<06:09, 1688.44 examples/s]Map (num_proc=18):  20%|██        | 157696/777453 [00:52<03:38, 2842.61 examples/s]Map (num_proc=18):  21%|██        | 159744/777453 [00:53<03:31, 2919.25 examples/s]Map (num_proc=18):  21%|██        | 161792/777453 [00:53<03:15, 3154.49 examples/s]Map (num_proc=18):  21%|██        | 163840/777453 [00:54<02:42, 3784.40 examples/s]Map (num_proc=18):  21%|██▏       | 165888/777453 [00:54<02:25, 4203.92 examples/s]Map (num_proc=18):  22%|██▏       | 167936/777453 [00:54<01:59, 5099.30 examples/s]Map (num_proc=18):  22%|██▏       | 169984/777453 [00:55<02:31, 3997.67 examples/s]Map (num_proc=18):  22%|██▏       | 172032/777453 [00:55<02:06, 4789.07 examples/s]Map (num_proc=18):  22%|██▏       | 174080/777453 [00:56<02:57, 3395.67 examples/s]Map (num_proc=18):  23%|██▎       | 176128/777453 [00:57<02:52, 3491.96 examples/s]Map (num_proc=18):  23%|██▎       | 178176/777453 [00:57<02:29, 4015.35 examples/s]Map (num_proc=18):  23%|██▎       | 180224/777453 [00:58<02:47, 3569.52 examples/s]Map (num_proc=18):  23%|██▎       | 182272/777453 [00:58<02:23, 4156.74 examples/s]Map (num_proc=18):  24%|██▎       | 184320/777453 [00:58<01:57, 5038.74 examples/s]Map (num_proc=18):  24%|██▍       | 186368/777453 [00:59<02:20, 4210.41 examples/s]Map (num_proc=18):  24%|██▍       | 190464/777453 [00:59<01:21, 7163.56 examples/s]Map (num_proc=18):  25%|██▍       | 192512/777453 [01:02<04:17, 2267.37 examples/s]Map (num_proc=18):  25%|██▌       | 194560/777453 [01:02<03:33, 2736.35 examples/s]Map (num_proc=18):  25%|██▌       | 196608/777453 [01:03<04:20, 2229.58 examples/s]Map (num_proc=18):  26%|██▌       | 198656/777453 [01:04<03:33, 2717.35 examples/s]Map (num_proc=18):  26%|██▌       | 200704/777453 [01:05<03:29, 2758.80 examples/s]Map (num_proc=18):  26%|██▌       | 202752/777453 [01:05<03:00, 3178.28 examples/s]Map (num_proc=18):  26%|██▋       | 204800/777453 [01:06<03:22, 2825.55 examples/s]Map (num_proc=18):  27%|██▋       | 208896/777453 [01:07<02:58, 3193.76 examples/s]Map (num_proc=18):  27%|██▋       | 212992/777453 [01:08<02:47, 3361.55 examples/s]Map (num_proc=18):  28%|██▊       | 217088/777453 [01:09<02:34, 3627.86 examples/s]Map (num_proc=18):  28%|██▊       | 219136/777453 [01:09<02:10, 4277.09 examples/s]Map (num_proc=18):  28%|██▊       | 221184/777453 [01:10<02:04, 4469.30 examples/s]Map (num_proc=18):  29%|██▊       | 223232/777453 [01:10<01:42, 5386.71 examples/s]Map (num_proc=18):  29%|██▉       | 225280/777453 [01:10<01:26, 6370.66 examples/s]Map (num_proc=18):  30%|██▉       | 229376/777453 [01:10<01:00, 9024.64 examples/s]Map (num_proc=18):  30%|██▉       | 231424/777453 [01:12<02:58, 3064.38 examples/s]Map (num_proc=18):  30%|███       | 233472/777453 [01:14<03:58, 2277.42 examples/s]Map (num_proc=18):  30%|███       | 235520/777453 [01:14<03:28, 2596.32 examples/s]Map (num_proc=18):  31%|███       | 237568/777453 [01:15<03:02, 2964.34 examples/s]Map (num_proc=18):  31%|███       | 239616/777453 [01:16<03:37, 2467.53 examples/s]Map (num_proc=18):  31%|███       | 241664/777453 [01:16<02:58, 3006.42 examples/s]Map (num_proc=18):  31%|███▏      | 243712/777453 [01:17<02:33, 3483.99 examples/s]Map (num_proc=18):  32%|███▏      | 245760/777453 [01:17<02:38, 3345.88 examples/s]Map (num_proc=18):  32%|███▏      | 247808/777453 [01:17<02:07, 4139.00 examples/s]Map (num_proc=18):  32%|███▏      | 249856/777453 [01:18<01:44, 5055.57 examples/s]Map (num_proc=18):  33%|███▎      | 253952/777453 [01:18<01:05, 7977.99 examples/s]Map (num_proc=18):  33%|███▎      | 256000/777453 [01:18<01:32, 5656.01 examples/s]Map (num_proc=18):  33%|███▎      | 258048/777453 [01:19<01:27, 5969.42 examples/s]Map (num_proc=18):  33%|███▎      | 260096/777453 [01:19<01:43, 5019.59 examples/s]Map (num_proc=18):  34%|███▎      | 262144/777453 [01:20<01:27, 5888.60 examples/s]Map (num_proc=18):  34%|███▍      | 264192/777453 [01:21<02:34, 3325.06 examples/s]Map (num_proc=18):  34%|███▍      | 266240/777453 [01:22<02:45, 3092.98 examples/s]Map (num_proc=18):  35%|███▍      | 268288/777453 [01:22<02:48, 3023.42 examples/s]Map (num_proc=18):  35%|███▍      | 270336/777453 [01:23<02:30, 3369.73 examples/s]Map (num_proc=18):  35%|███▌      | 274432/777453 [01:23<01:56, 4302.37 examples/s]Map (num_proc=18):  36%|███▌      | 276480/777453 [01:25<03:34, 2336.05 examples/s]Map (num_proc=18):  36%|███▌      | 278528/777453 [01:27<03:58, 2092.76 examples/s]Map (num_proc=18):  36%|███▌      | 280576/777453 [01:27<03:15, 2537.32 examples/s]Map (num_proc=18):  36%|███▋      | 282624/777453 [01:27<02:45, 2995.08 examples/s]Map (num_proc=18):  37%|███▋      | 284672/777453 [01:28<02:30, 3270.65 examples/s]Map (num_proc=18):  37%|███▋      | 286720/777453 [01:29<02:36, 3128.54 examples/s]Map (num_proc=18):  37%|███▋      | 288768/777453 [01:29<02:01, 4037.48 examples/s]Map (num_proc=18):  37%|███▋      | 290816/777453 [01:29<01:57, 4133.06 examples/s]Map (num_proc=18):  38%|███▊      | 292864/777453 [01:30<02:06, 3843.31 examples/s]Map (num_proc=18):  38%|███▊      | 294912/777453 [01:30<01:57, 4105.48 examples/s]Map (num_proc=18):  38%|███▊      | 296960/777453 [01:30<01:29, 5356.33 examples/s]Map (num_proc=18):  38%|███▊      | 299008/777453 [01:31<01:41, 4714.04 examples/s]Map (num_proc=18):  39%|███▊      | 301056/777453 [01:33<03:06, 2559.04 examples/s]Map (num_proc=18):  39%|███▉      | 303104/777453 [01:34<03:28, 2276.42 examples/s]Map (num_proc=18):  39%|███▉      | 305152/777453 [01:35<03:28, 2267.09 examples/s]Map (num_proc=18):  40%|███▉      | 307200/777453 [01:35<02:35, 3026.27 examples/s]Map (num_proc=18):  40%|███▉      | 309248/777453 [01:35<02:14, 3472.44 examples/s]Map (num_proc=18):  40%|████      | 311296/777453 [01:36<02:04, 3734.22 examples/s]Map (num_proc=18):  40%|████      | 313344/777453 [01:36<01:42, 4509.64 examples/s]Map (num_proc=18):  41%|████      | 315392/777453 [01:37<02:04, 3702.88 examples/s]Map (num_proc=18):  41%|████      | 317440/777453 [01:38<02:24, 3187.10 examples/s]Map (num_proc=18):  41%|████▏     | 321536/777453 [01:38<01:50, 4137.44 examples/s]Map (num_proc=18):  42%|████▏     | 323584/777453 [01:39<01:44, 4324.59 examples/s]Map (num_proc=18):  42%|████▏     | 325632/777453 [01:39<01:44, 4336.70 examples/s]Map (num_proc=18):  42%|████▏     | 327680/777453 [01:40<01:49, 4105.32 examples/s]Map (num_proc=18):  42%|████▏     | 329728/777453 [01:40<02:05, 3581.05 examples/s]Map (num_proc=18):  43%|████▎     | 331776/777453 [01:41<02:28, 2996.92 examples/s]Map (num_proc=18):  43%|████▎     | 334008/777453 [01:42<02:19, 3180.67 examples/s]Map (num_proc=18):  43%|████▎     | 336056/777453 [01:43<02:42, 2719.47 examples/s]Map (num_proc=18):  43%|████▎     | 338104/777453 [01:43<02:11, 3340.27 examples/s]Map (num_proc=18):  44%|████▍     | 340152/777453 [01:44<02:10, 3347.04 examples/s]Map (num_proc=18):  44%|████▍     | 342200/777453 [01:44<02:01, 3584.97 examples/s]Map (num_proc=18):  44%|████▍     | 344248/777453 [01:45<01:41, 4264.05 examples/s]Map (num_proc=18):  45%|████▍     | 346296/777453 [01:45<01:25, 5052.28 examples/s]Map (num_proc=18):  45%|████▌     | 350392/777453 [01:45<00:58, 7276.46 examples/s]Map (num_proc=18):  45%|████▌     | 352440/777453 [01:46<01:30, 4696.94 examples/s]Map (num_proc=18):  46%|████▌     | 354488/777453 [01:47<01:37, 4355.09 examples/s]Map (num_proc=18):  46%|████▌     | 356536/777453 [01:47<01:41, 4134.93 examples/s]Map (num_proc=18):  46%|████▌     | 358584/777453 [01:48<01:54, 3672.89 examples/s]Map (num_proc=18):  46%|████▋     | 360632/777453 [01:49<02:01, 3430.87 examples/s]Map (num_proc=18):  47%|████▋     | 362680/777453 [01:49<02:02, 3373.43 examples/s]Map (num_proc=18):  47%|████▋     | 364728/777453 [01:50<01:57, 3520.24 examples/s]Map (num_proc=18):  47%|████▋     | 366776/777453 [01:50<01:39, 4121.94 examples/s]Map (num_proc=18):  47%|████▋     | 368824/777453 [01:50<01:25, 4757.40 examples/s]Map (num_proc=18):  48%|████▊     | 370872/777453 [01:51<01:39, 4081.57 examples/s]Map (num_proc=18):  48%|████▊     | 372920/777453 [01:51<01:27, 4609.14 examples/s]Map (num_proc=18):  48%|████▊     | 374968/777453 [01:52<02:06, 3171.19 examples/s]Map (num_proc=18):  48%|████▊     | 377016/777453 [01:53<02:29, 2679.85 examples/s]Map (num_proc=18):  49%|████▉     | 379064/777453 [01:55<03:07, 2129.99 examples/s]Map (num_proc=18):  49%|████▉     | 381112/777453 [01:55<02:23, 2756.15 examples/s]Map (num_proc=18):  49%|████▉     | 383160/777453 [01:55<01:54, 3432.72 examples/s]Map (num_proc=18):  50%|████▉     | 385208/777453 [01:56<02:11, 2985.91 examples/s]Map (num_proc=18):  50%|████▉     | 387256/777453 [01:57<02:17, 2835.67 examples/s]Map (num_proc=18):  50%|█████     | 389304/777453 [01:58<02:45, 2343.10 examples/s]Map (num_proc=18):  50%|█████     | 391352/777453 [01:59<02:27, 2626.19 examples/s]Map (num_proc=18):  51%|█████     | 393400/777453 [01:59<01:49, 3514.83 examples/s]Map (num_proc=18):  51%|█████     | 395448/777453 [01:59<01:33, 4091.45 examples/s]Map (num_proc=18):  51%|█████     | 397496/777453 [02:01<02:27, 2575.09 examples/s]Map (num_proc=18):  51%|█████▏    | 399544/777453 [02:01<02:02, 3093.07 examples/s]Map (num_proc=18):  52%|█████▏    | 401592/777453 [02:02<02:15, 2783.64 examples/s]Map (num_proc=18):  52%|█████▏    | 403640/777453 [02:03<02:20, 2669.38 examples/s]Map (num_proc=18):  52%|█████▏    | 407736/777453 [02:03<01:24, 4363.52 examples/s]Map (num_proc=18):  53%|█████▎    | 409784/777453 [02:03<01:12, 5101.33 examples/s]Map (num_proc=18):  53%|█████▎    | 411832/777453 [02:04<01:11, 5114.55 examples/s]Map (num_proc=18):  53%|█████▎    | 413880/777453 [02:04<01:06, 5464.86 examples/s]Map (num_proc=18):  53%|█████▎    | 415928/777453 [02:05<01:49, 3298.87 examples/s]Map (num_proc=18):  54%|█████▍    | 417976/777453 [02:06<01:36, 3729.97 examples/s]Map (num_proc=18):  54%|█████▍    | 420024/777453 [02:06<01:20, 4417.15 examples/s]Map (num_proc=18):  54%|█████▍    | 422072/777453 [02:06<01:08, 5159.74 examples/s]Map (num_proc=18):  55%|█████▍    | 424120/777453 [02:07<01:28, 3998.66 examples/s]Map (num_proc=18):  55%|█████▍    | 426168/777453 [02:07<01:08, 5119.25 examples/s]Map (num_proc=18):  55%|█████▌    | 428216/777453 [02:08<01:17, 4499.34 examples/s]Map (num_proc=18):  55%|█████▌    | 430264/777453 [02:08<01:28, 3906.40 examples/s]Map (num_proc=18):  56%|█████▌    | 432312/777453 [02:10<02:24, 2390.23 examples/s]Map (num_proc=18):  56%|█████▌    | 434360/777453 [02:10<01:56, 2937.70 examples/s]Map (num_proc=18):  56%|█████▌    | 436408/777453 [02:11<01:57, 2898.21 examples/s]Map (num_proc=18):  56%|█████▋    | 438456/777453 [02:13<02:55, 1929.31 examples/s]Map (num_proc=18):  57%|█████▋    | 440504/777453 [02:13<02:17, 2448.05 examples/s]Map (num_proc=18):  57%|█████▋    | 444600/777453 [02:14<01:48, 3055.63 examples/s]Map (num_proc=18):  57%|█████▋    | 446648/777453 [02:15<01:47, 3068.45 examples/s]Map (num_proc=18):  58%|█████▊    | 448696/777453 [02:15<01:25, 3851.52 examples/s]Map (num_proc=18):  58%|█████▊    | 452792/777453 [02:15<01:00, 5351.27 examples/s]Map (num_proc=18):  59%|█████▊    | 454840/777453 [02:16<01:07, 4814.23 examples/s]Map (num_proc=18):  59%|█████▉    | 456888/777453 [02:16<01:02, 5098.94 examples/s]Map (num_proc=18):  59%|█████▉    | 458936/777453 [02:18<01:40, 3161.86 examples/s]Map (num_proc=18):  59%|█████▉    | 460984/777453 [02:18<01:30, 3503.57 examples/s]Map (num_proc=18):  60%|█████▉    | 463032/777453 [02:19<01:49, 2858.58 examples/s]Map (num_proc=18):  60%|█████▉    | 465080/777453 [02:19<01:25, 3636.66 examples/s]Map (num_proc=18):  60%|██████    | 469176/777453 [02:19<00:52, 5925.67 examples/s]Map (num_proc=18):  61%|██████    | 471224/777453 [02:20<01:19, 3847.36 examples/s]Map (num_proc=18):  61%|██████    | 473272/777453 [02:21<01:26, 3523.24 examples/s]Map (num_proc=18):  61%|██████    | 475320/777453 [02:21<01:10, 4276.21 examples/s]Map (num_proc=18):  61%|██████▏   | 477552/777453 [02:22<01:02, 4767.31 examples/s]Map (num_proc=18):  62%|██████▏   | 479600/777453 [02:23<01:22, 3621.59 examples/s]Map (num_proc=18):  62%|██████▏   | 481648/777453 [02:23<01:28, 3356.55 examples/s]Map (num_proc=18):  62%|██████▏   | 485744/777453 [02:24<01:22, 3539.18 examples/s]Map (num_proc=18):  63%|██████▎   | 487792/777453 [02:25<01:21, 3561.78 examples/s]Map (num_proc=18):  63%|██████▎   | 489840/777453 [02:25<01:08, 4210.95 examples/s]Map (num_proc=18):  63%|██████▎   | 491888/777453 [02:27<01:41, 2813.42 examples/s]Map (num_proc=18):  64%|██████▎   | 493936/777453 [02:27<01:46, 2666.16 examples/s]Map (num_proc=18):  64%|██████▍   | 495984/777453 [02:28<01:26, 3268.75 examples/s]Map (num_proc=18):  64%|██████▍   | 498032/777453 [02:28<01:22, 3379.55 examples/s]Map (num_proc=18):  64%|██████▍   | 500080/777453 [02:29<01:41, 2743.81 examples/s]Map (num_proc=18):  65%|██████▍   | 502128/777453 [02:30<01:27, 3141.40 examples/s]Map (num_proc=18):  65%|██████▍   | 504176/777453 [02:30<01:11, 3823.57 examples/s]Map (num_proc=18):  65%|██████▌   | 506224/777453 [02:31<01:11, 3799.58 examples/s]Map (num_proc=18):  65%|██████▌   | 508272/777453 [02:32<01:25, 3151.55 examples/s]Map (num_proc=18):  66%|██████▌   | 510320/777453 [02:32<01:33, 2864.82 examples/s]Map (num_proc=18):  66%|██████▌   | 512368/777453 [02:33<01:20, 3302.21 examples/s]Map (num_proc=18):  66%|██████▌   | 514416/777453 [02:33<01:04, 4052.84 examples/s]Map (num_proc=18):  66%|██████▋   | 516464/777453 [02:33<00:49, 5232.12 examples/s]Map (num_proc=18):  67%|██████▋   | 518512/777453 [02:34<00:53, 4832.17 examples/s]Map (num_proc=18):  67%|██████▋   | 520744/777453 [02:34<01:03, 4029.19 examples/s]Map (num_proc=18):  67%|██████▋   | 522792/777453 [02:35<00:59, 4278.56 examples/s]Map (num_proc=18):  68%|██████▊   | 524840/777453 [02:36<01:38, 2555.09 examples/s]Map (num_proc=18):  68%|██████▊   | 527071/777453 [02:37<01:21, 3088.16 examples/s]Map (num_proc=18):  68%|██████▊   | 529119/777453 [02:37<01:02, 3948.23 examples/s]Map (num_proc=18):  68%|██████▊   | 531167/777453 [02:38<01:05, 3764.71 examples/s]Map (num_proc=18):  69%|██████▊   | 533215/777453 [02:38<01:01, 3980.32 examples/s]Map (num_proc=18):  69%|██████▉   | 535263/777453 [02:38<00:52, 4581.86 examples/s]Map (num_proc=18):  69%|██████▉   | 537311/777453 [02:40<01:25, 2813.37 examples/s]Map (num_proc=18):  69%|██████▉   | 539359/777453 [02:40<01:03, 3768.21 examples/s]Map (num_proc=18):  70%|██████▉   | 543455/777453 [02:40<00:44, 5258.18 examples/s]Map (num_proc=18):  70%|███████   | 545503/777453 [02:40<00:40, 5743.20 examples/s]Map (num_proc=18):  70%|███████   | 547551/777453 [02:41<00:39, 5862.37 examples/s]Map (num_proc=18):  71%|███████   | 549599/777453 [02:41<00:33, 6785.99 examples/s]Map (num_proc=18):  71%|███████   | 551647/777453 [02:41<00:37, 6050.35 examples/s]Map (num_proc=18):  71%|███████   | 553695/777453 [02:42<00:47, 4713.40 examples/s]Map (num_proc=18):  71%|███████▏  | 555743/777453 [02:43<00:51, 4290.10 examples/s]Map (num_proc=18):  72%|███████▏  | 557791/777453 [02:44<01:22, 2663.91 examples/s]Map (num_proc=18):  72%|███████▏  | 559839/777453 [02:44<01:05, 3301.48 examples/s]Map (num_proc=18):  72%|███████▏  | 561887/777453 [02:45<01:11, 2996.39 examples/s]Map (num_proc=18):  73%|███████▎  | 563935/777453 [02:47<01:43, 2056.93 examples/s]Map (num_proc=18):  73%|███████▎  | 565983/777453 [02:48<01:36, 2195.14 examples/s]Map (num_proc=18):  73%|███████▎  | 568031/777453 [02:48<01:18, 2672.93 examples/s]Map (num_proc=18):  73%|███████▎  | 570079/777453 [02:49<01:25, 2433.78 examples/s]Map (num_proc=18):  74%|███████▍  | 574175/777453 [02:50<00:55, 3676.20 examples/s]Map (num_proc=18):  74%|███████▍  | 576223/777453 [02:50<00:44, 4569.07 examples/s]Map (num_proc=18):  74%|███████▍  | 578271/777453 [02:50<00:44, 4514.31 examples/s]Map (num_proc=18):  75%|███████▍  | 580319/777453 [02:52<01:10, 2802.12 examples/s]Map (num_proc=18):  75%|███████▍  | 582367/777453 [02:52<01:11, 2720.07 examples/s]Map (num_proc=18):  75%|███████▌  | 584415/777453 [02:53<01:06, 2915.87 examples/s]Map (num_proc=18):  75%|███████▌  | 586463/777453 [02:53<00:58, 3276.59 examples/s]Map (num_proc=18):  76%|███████▌  | 590559/777453 [02:54<00:35, 5193.87 examples/s]Map (num_proc=18):  76%|███████▌  | 592607/777453 [02:54<00:37, 4962.38 examples/s]Map (num_proc=18):  76%|███████▋  | 594655/777453 [02:55<00:40, 4530.29 examples/s]Map (num_proc=18):  77%|███████▋  | 598751/777453 [02:55<00:35, 5071.09 examples/s]Map (num_proc=18):  77%|███████▋  | 600799/777453 [02:56<00:46, 3788.72 examples/s]Map (num_proc=18):  78%|███████▊  | 602847/777453 [02:58<00:59, 2922.93 examples/s]Map (num_proc=18):  78%|███████▊  | 604895/777453 [02:59<01:08, 2510.51 examples/s]Map (num_proc=18):  78%|███████▊  | 606943/777453 [02:59<01:02, 2720.17 examples/s]Map (num_proc=18):  78%|███████▊  | 608991/777453 [03:00<01:09, 2441.38 examples/s]Map (num_proc=18):  79%|███████▉  | 613087/777453 [03:01<00:44, 3735.42 examples/s]Map (num_proc=18):  79%|███████▉  | 615135/777453 [03:01<00:37, 4358.80 examples/s]Map (num_proc=18):  79%|███████▉  | 617183/777453 [03:01<00:38, 4193.34 examples/s]Map (num_proc=18):  80%|███████▉  | 619231/777453 [03:03<00:52, 3023.74 examples/s]Map (num_proc=18):  80%|███████▉  | 621279/777453 [03:03<00:53, 2925.10 examples/s]Map (num_proc=18):  80%|████████  | 623327/777453 [03:04<00:50, 3023.98 examples/s]Map (num_proc=18):  80%|████████  | 625375/777453 [03:04<00:39, 3818.54 examples/s]Map (num_proc=18):  81%|████████  | 629471/777453 [03:05<00:37, 3915.62 examples/s]Map (num_proc=18):  81%|████████  | 631519/777453 [03:06<00:44, 3279.06 examples/s]Map (num_proc=18):  81%|████████▏ | 633567/777453 [03:07<00:39, 3687.42 examples/s]Map (num_proc=18):  82%|████████▏ | 635615/777453 [03:08<00:51, 2744.80 examples/s]Map (num_proc=18):  82%|████████▏ | 637663/777453 [03:08<00:41, 3369.70 examples/s]Map (num_proc=18):  82%|████████▏ | 639711/777453 [03:09<00:45, 3003.68 examples/s]Map (num_proc=18):  83%|████████▎ | 641759/777453 [03:09<00:36, 3695.30 examples/s]Map (num_proc=18):  83%|████████▎ | 643807/777453 [03:09<00:29, 4589.42 examples/s]Map (num_proc=18):  83%|████████▎ | 645855/777453 [03:10<00:32, 4036.59 examples/s]Map (num_proc=18):  83%|████████▎ | 647903/777453 [03:10<00:28, 4598.06 examples/s]Map (num_proc=18):  84%|████████▎ | 650135/777453 [03:11<00:34, 3713.53 examples/s]Map (num_proc=18):  84%|████████▍ | 652183/777453 [03:12<00:32, 3808.72 examples/s]Map (num_proc=18):  84%|████████▍ | 654231/777453 [03:12<00:27, 4547.72 examples/s]Map (num_proc=18):  84%|████████▍ | 656279/777453 [03:12<00:27, 4437.52 examples/s]Map (num_proc=18):  85%|████████▍ | 658327/777453 [03:13<00:32, 3670.30 examples/s]Map (num_proc=18):  85%|████████▍ | 660559/777453 [03:15<00:46, 2488.26 examples/s]Map (num_proc=18):  85%|████████▌ | 662607/777453 [03:15<00:44, 2565.45 examples/s]Map (num_proc=18):  86%|████████▌ | 664838/777453 [03:16<00:35, 3191.14 examples/s]Map (num_proc=18):  86%|████████▌ | 666886/777453 [03:16<00:26, 4134.00 examples/s]Map (num_proc=18):  86%|████████▋ | 670982/777453 [03:16<00:17, 6118.17 examples/s]Map (num_proc=18):  87%|████████▋ | 673214/777453 [03:17<00:21, 4792.86 examples/s]Map (num_proc=18):  87%|████████▋ | 675262/777453 [03:17<00:19, 5179.34 examples/s]Map (num_proc=18):  87%|████████▋ | 677310/777453 [03:19<00:33, 2948.39 examples/s]Map (num_proc=18):  87%|████████▋ | 679358/777453 [03:20<00:36, 2651.40 examples/s]Map (num_proc=18):  88%|████████▊ | 681406/777453 [03:20<00:28, 3337.20 examples/s]Map (num_proc=18):  88%|████████▊ | 685502/777453 [03:21<00:23, 3847.21 examples/s]Map (num_proc=18):  88%|████████▊ | 687550/777453 [03:21<00:21, 4119.66 examples/s]Map (num_proc=18):  89%|████████▊ | 689598/777453 [03:22<00:28, 3040.64 examples/s]Map (num_proc=18):  89%|████████▉ | 691646/777453 [03:23<00:22, 3843.55 examples/s]Map (num_proc=18):  89%|████████▉ | 693694/777453 [03:23<00:21, 3819.78 examples/s]Map (num_proc=18):  89%|████████▉ | 695742/777453 [03:24<00:22, 3621.48 examples/s]Map (num_proc=18):  90%|████████▉ | 697974/777453 [03:24<00:19, 4102.76 examples/s]Map (num_proc=18):  90%|█████████ | 700022/777453 [03:25<00:18, 4086.59 examples/s]Map (num_proc=18):  91%|█████████ | 704118/777453 [03:26<00:17, 4309.68 examples/s]Map (num_proc=18):  91%|█████████ | 706166/777453 [03:26<00:14, 5015.75 examples/s]Map (num_proc=18):  91%|█████████ | 708214/777453 [03:27<00:20, 3334.91 examples/s]Map (num_proc=18):  91%|█████████▏| 710262/777453 [03:28<00:25, 2584.63 examples/s]Map (num_proc=18):  92%|█████████▏| 712310/777453 [03:28<00:20, 3162.10 examples/s]Map (num_proc=18):  92%|█████████▏| 714358/777453 [03:30<00:27, 2313.37 examples/s]Map (num_proc=18):  92%|█████████▏| 716589/777453 [03:30<00:21, 2842.07 examples/s]Map (num_proc=18):  92%|█████████▏| 718821/777453 [03:31<00:16, 3567.24 examples/s]Map (num_proc=18):  93%|█████████▎| 720869/777453 [03:31<00:12, 4541.33 examples/s]Map (num_proc=18):  93%|█████████▎| 722917/777453 [03:31<00:14, 3842.17 examples/s]Map (num_proc=18):  93%|█████████▎| 724965/777453 [03:33<00:18, 2836.18 examples/s]Map (num_proc=18):  94%|█████████▎| 727013/777453 [03:33<00:16, 3050.77 examples/s]Map (num_proc=18):  94%|█████████▍| 729061/777453 [03:34<00:16, 2973.51 examples/s]Map (num_proc=18):  94%|█████████▍| 731109/777453 [03:35<00:16, 2743.59 examples/s]Map (num_proc=18):  94%|█████████▍| 733157/777453 [03:35<00:13, 3224.99 examples/s]Map (num_proc=18):  95%|█████████▍| 735205/777453 [03:36<00:11, 3568.75 examples/s]Map (num_proc=18):  95%|█████████▍| 737253/777453 [03:36<00:11, 3352.23 examples/s]Map (num_proc=18):  95%|█████████▌| 739301/777453 [03:37<00:10, 3592.10 examples/s]Map (num_proc=18):  95%|█████████▌| 741349/777453 [03:37<00:08, 4421.43 examples/s]Map (num_proc=18):  96%|█████████▌| 743581/777453 [03:39<00:13, 2467.06 examples/s]Map (num_proc=18):  96%|█████████▌| 745813/777453 [03:39<00:11, 2682.58 examples/s]Map (num_proc=18):  96%|█████████▌| 747861/777453 [03:40<00:09, 3040.43 examples/s]Map (num_proc=18):  96%|█████████▋| 749909/777453 [03:40<00:08, 3390.08 examples/s]Map (num_proc=18):  97%|█████████▋| 751957/777453 [03:41<00:07, 3248.12 examples/s]Map (num_proc=18):  97%|█████████▋| 754005/777453 [03:41<00:06, 3595.54 examples/s]Map (num_proc=18):  97%|█████████▋| 756053/777453 [03:43<00:09, 2148.15 examples/s]Map (num_proc=18):  98%|█████████▊| 758101/777453 [03:44<00:07, 2465.58 examples/s]Map (num_proc=18):  98%|█████████▊| 760149/777453 [03:44<00:05, 3071.92 examples/s]Map (num_proc=18):  98%|█████████▊| 762381/777453 [03:44<00:04, 3614.43 examples/s]Map (num_proc=18):  98%|█████████▊| 764613/777453 [03:45<00:02, 4490.71 examples/s]Map (num_proc=18):  99%|█████████▊| 766661/777453 [03:46<00:04, 2468.96 examples/s]Map (num_proc=18):  99%|█████████▉| 768709/777453 [03:47<00:03, 2869.73 examples/s]Map (num_proc=18):  99%|█████████▉| 770941/777453 [03:48<00:02, 2654.86 examples/s]Map (num_proc=18):  99%|█████████▉| 773173/777453 [03:49<00:01, 2289.97 examples/s]Map (num_proc=18): 100%|█████████▉| 775221/777453 [03:52<00:01, 1450.20 examples/s]Map (num_proc=18): 100%|█████████▉| 777269/777453 [03:56<00:00, 883.82 examples/s] Map (num_proc=18): 100%|██████████| 777453/777453 [03:57<00:00, 3277.95 examples/s]
Shuffling dataset with seed 42
[rank0]: Traceback (most recent call last):
[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 197, in <module>
[rank0]:     run()
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 163, in run
[rank0]:     model, dataset = load_artifacts(args, rank)
[rank0]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 135, in load_artifacts
[rank0]:     dataset = dataset.select(range(limit))
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/fingerprint.py", line 482, in wrapper
[rank0]:     out = func(dataset, *args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 3949, in select
[rank0]:     return self._select_contiguous(start, length, new_fingerprint=new_fingerprint)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/fingerprint.py", line 482, in wrapper
[rank0]:     out = func(dataset, *args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 4010, in _select_contiguous
[rank0]:     _check_valid_indices_value(start + length - 1, len(self))
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 659, in _check_valid_indices_value
[rank0]:     raise IndexError(f"Index {index} out of range for dataset of size {size}.")
[rank0]: IndexError: Index 6557945 out of range for dataset of size 6557945.
[rank0]:[W619 16:43:51.095340594 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0619 16:43:52.210000 1748674 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1748684 closing signal SIGTERM
E0619 16:43:52.477000 1748674 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 1748683) of binary: /home/tilman.kerl/miniconda3/envs/refusal/bin/python
Traceback (most recent call last):
  File "/home/tilman.kerl/miniconda3/envs/refusal/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
sparsify FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-19_16:43:52
  host      : avm-a100-d-10.novalocal
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1748683)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
