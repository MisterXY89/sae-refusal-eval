W0618 00:15:00.088000 2898667 site-packages/torch/distributed/run.py:792] 
W0618 00:15:00.088000 2898667 site-packages/torch/distributed/run.py:792] *****************************************
W0618 00:15:00.088000 2898667 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0618 00:15:00.088000 2898667 site-packages/torch/distributed/run.py:792] *****************************************
Using DDP across 2 GPUs.
Shuffling dataset with seed 42
Training on 'MisterXY89/lmsys-processed' (split 'train')
Storing model weights in torch.bfloat16
Training on modules: ['layers.18']
Initializing SAEs with random seed(s) [0]
Learning rate: 6.67e-03
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: tilmankerl (tilmankerl-technical-university-of-vienna) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /home/tilman.kerl/mech-interp/src/train/LMSYS/wandb/run-20250618_001514-7fadqj4n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smollm2-sparsify-lmsys-2M-token-18-layers-16-expansion-64-k
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tilmankerl-technical-university-of-vienna/sparsify
wandb: üöÄ View run at https://wandb.ai/tilmankerl-technical-university-of-vienna/sparsify/runs/7fadqj4n
Number of SAE parameters: 10_626_624
Number of model parameters: 134_515_008
Training:   0%|          | 0/610 [00:00<?, ?it/s]Training:   0%|          | 1/610 [00:01<11:07,  1.10s/it]Training:   1%|          | 4/610 [00:01<02:23,  4.21it/s]Training:   1%|          | 7/610 [00:01<01:18,  7.70it/s]Training:   2%|‚ñè         | 11/610 [00:01<00:47, 12.50it/s]Training:   2%|‚ñè         | 15/610 [00:01<00:35, 16.80it/s]Training:   3%|‚ñé         | 19/610 [00:01<00:28, 20.42it/s]Training:   4%|‚ñç         | 23/610 [00:01<00:25, 23.38it/s]Training:   4%|‚ñç         | 27/610 [00:01<00:22, 25.63it/s]Training:   5%|‚ñå         | 31/610 [00:02<00:21, 27.35it/s]Training:   6%|‚ñå         | 35/610 [00:02<00:20, 28.65it/s]Training:   6%|‚ñã         | 39/610 [00:02<00:19, 29.60it/s]Training:   7%|‚ñã         | 43/610 [00:02<00:18, 30.31it/s]Training:   8%|‚ñä         | 47/610 [00:02<00:18, 30.82it/s]Training:   8%|‚ñä         | 51/610 [00:02<00:17, 31.14it/s]Training:   9%|‚ñâ         | 55/610 [00:02<00:17, 31.39it/s]Training:  10%|‚ñâ         | 59/610 [00:02<00:17, 31.56it/s]Training:  10%|‚ñà         | 63/610 [00:03<00:17, 31.66it/s]Training:  11%|‚ñà         | 67/610 [00:03<00:17, 30.97it/s]Training:  12%|‚ñà‚ñè        | 71/610 [00:03<00:18, 29.41it/s]Training:  12%|‚ñà‚ñè        | 75/610 [00:03<00:17, 30.20it/s]Training:  13%|‚ñà‚ñé        | 79/610 [00:03<00:17, 30.61it/s]Training:  14%|‚ñà‚ñé        | 83/610 [00:03<00:16, 31.07it/s]Training:  14%|‚ñà‚ñç        | 87/610 [00:03<00:16, 31.41it/s]Training:  15%|‚ñà‚ñç        | 91/610 [00:03<00:16, 31.71it/s]Training:  16%|‚ñà‚ñå        | 95/610 [00:04<00:16, 31.76it/s]Training:  16%|‚ñà‚ñå        | 99/610 [00:04<00:15, 31.95it/s]Training:  17%|‚ñà‚ñã        | 103/610 [00:04<00:15, 32.12it/s]Training:  18%|‚ñà‚ñä        | 107/610 [00:04<00:15, 32.12it/s]Training:  18%|‚ñà‚ñä        | 111/610 [00:04<00:15, 32.08it/s]Training:  19%|‚ñà‚ñâ        | 115/610 [00:04<00:15, 32.18it/s]Training:  20%|‚ñà‚ñâ        | 119/610 [00:04<00:15, 32.15it/s]Training:  20%|‚ñà‚ñà        | 123/610 [00:04<00:15, 31.79it/s]Training:  21%|‚ñà‚ñà        | 127/610 [00:05<00:15, 31.93it/s]Training:  21%|‚ñà‚ñà‚ñè       | 131/610 [00:05<00:14, 32.03it/s]Training:  22%|‚ñà‚ñà‚ñè       | 135/610 [00:05<00:14, 32.10it/s]Training:  23%|‚ñà‚ñà‚ñé       | 139/610 [00:05<00:14, 32.13it/s]Training:  23%|‚ñà‚ñà‚ñé       | 143/610 [00:05<00:14, 32.18it/s]Training:  24%|‚ñà‚ñà‚ñç       | 147/610 [00:05<00:14, 32.18it/s]Training:  25%|‚ñà‚ñà‚ñç       | 151/610 [00:05<00:14, 32.20it/s]Training:  25%|‚ñà‚ñà‚ñå       | 155/610 [00:05<00:14, 32.04it/s]Training:  26%|‚ñà‚ñà‚ñå       | 159/610 [00:06<00:14, 31.95it/s]Training:  27%|‚ñà‚ñà‚ñã       | 163/610 [00:06<00:14, 31.81it/s]Training:  27%|‚ñà‚ñà‚ñã       | 167/610 [00:06<00:13, 31.70it/s]Training:  28%|‚ñà‚ñà‚ñä       | 171/610 [00:06<00:13, 31.60it/s]Training:  29%|‚ñà‚ñà‚ñä       | 175/610 [00:06<00:13, 31.61it/s]Training:  29%|‚ñà‚ñà‚ñâ       | 179/610 [00:06<00:14, 29.90it/s]Training:  30%|‚ñà‚ñà‚ñà       | 183/610 [00:06<00:14, 29.54it/s]Training:  30%|‚ñà‚ñà‚ñà       | 186/610 [00:07<00:14, 28.94it/s]Training:  31%|‚ñà‚ñà‚ñà       | 190/610 [00:07<00:14, 29.82it/s]Training:  32%|‚ñà‚ñà‚ñà‚ñè      | 194/610 [00:07<00:13, 30.29it/s]Training:  32%|‚ñà‚ñà‚ñà‚ñè      | 198/610 [00:07<00:13, 30.66it/s]Training:  33%|‚ñà‚ñà‚ñà‚ñé      | 202/610 [00:07<00:13, 30.89it/s]Training:  34%|‚ñà‚ñà‚ñà‚ñç      | 206/610 [00:07<00:12, 31.11it/s]Training:  34%|‚ñà‚ñà‚ñà‚ñç      | 210/610 [00:07<00:12, 31.38it/s]Training:  35%|‚ñà‚ñà‚ñà‚ñå      | 214/610 [00:07<00:12, 31.48it/s]Training:  36%|‚ñà‚ñà‚ñà‚ñå      | 218/610 [00:08<00:12, 31.52it/s]Training:  36%|‚ñà‚ñà‚ñà‚ñã      | 222/610 [00:08<00:12, 31.68it/s]Training:  37%|‚ñà‚ñà‚ñà‚ñã      | 226/610 [00:08<00:12, 31.64it/s]Training:  38%|‚ñà‚ñà‚ñà‚ñä      | 230/610 [00:08<00:12, 31.63it/s]Training:  38%|‚ñà‚ñà‚ñà‚ñä      | 234/610 [00:08<00:11, 31.62it/s]Training:  39%|‚ñà‚ñà‚ñà‚ñâ      | 238/610 [00:08<00:12, 30.34it/s]Training:  40%|‚ñà‚ñà‚ñà‚ñâ      | 242/610 [00:08<00:11, 30.82it/s]Training:  40%|‚ñà‚ñà‚ñà‚ñà      | 246/610 [00:08<00:11, 31.13it/s]Training:  41%|‚ñà‚ñà‚ñà‚ñà      | 250/610 [00:09<00:11, 31.32it/s]Training:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 254/610 [00:09<00:11, 30.37it/s]Training:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 258/610 [00:09<00:11, 30.78it/s]Training:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 262/610 [00:09<00:11, 30.99it/s]Training:  44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 266/610 [00:09<00:11, 31.17it/s]Training:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 270/610 [00:09<00:10, 31.42it/s]Training:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 274/610 [00:09<00:10, 31.42it/s]Training:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 278/610 [00:09<00:10, 31.38it/s]Training:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 282/610 [00:10<00:10, 29.88it/s]Training:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 286/610 [00:10<00:10, 29.46it/s]Training:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 290/610 [00:10<00:10, 30.09it/s]Training:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 294/610 [00:10<00:10, 28.81it/s]Training:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 298/610 [00:10<00:10, 29.63it/s]Training:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 302/610 [00:10<00:10, 30.14it/s]Training:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 306/610 [00:10<00:09, 30.61it/s]Training:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 310/610 [00:11<00:09, 31.02it/s]Training:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 314/610 [00:11<00:09, 31.21it/s]Training:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 318/610 [00:11<00:09, 31.44it/s]Training:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 322/610 [00:11<00:09, 31.52it/s]Training:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 326/610 [00:11<00:08, 31.62it/s]Training:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 330/610 [00:11<00:08, 31.63it/s]Training:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 334/610 [00:11<00:08, 31.61it/s]Training:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 338/610 [00:11<00:08, 31.68it/s]Training:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 342/610 [00:12<00:08, 31.71it/s]Training:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 346/610 [00:12<00:08, 31.72it/s]Training:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 350/610 [00:12<00:08, 31.59it/s]Training:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 354/610 [00:12<00:08, 31.71it/s]Training:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 358/610 [00:12<00:07, 31.72it/s]Training:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 362/610 [00:12<00:07, 31.81it/s]Training:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 366/610 [00:12<00:07, 31.85it/s]Training:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 370/610 [00:12<00:07, 31.74it/s]Training:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 374/610 [00:13<00:07, 31.81it/s]Training:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 378/610 [00:13<00:07, 31.79it/s]Training:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 382/610 [00:13<00:07, 31.66it/s]Training:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 386/610 [00:13<00:07, 31.71it/s]Training:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 390/610 [00:13<00:06, 31.69it/s]Training:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 394/610 [00:13<00:06, 31.83it/s]Training:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 398/610 [00:13<00:06, 31.71it/s]Training:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 402/610 [00:13<00:06, 31.79it/s]Training:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 406/610 [00:14<00:06, 31.82it/s]Training:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 410/610 [00:14<00:06, 31.93it/s]Training:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 414/610 [00:14<00:06, 31.86it/s]Training:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 418/610 [00:14<00:06, 31.87it/s]Training:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 422/610 [00:14<00:05, 31.95it/s]Training:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 426/610 [00:14<00:05, 31.64it/s]Training:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 430/610 [00:14<00:05, 31.69it/s]Training:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 434/610 [00:14<00:05, 31.74it/s]Training:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 438/610 [00:15<00:05, 31.84it/s]Training:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 442/610 [00:15<00:05, 31.73it/s]Training:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 446/610 [00:15<00:05, 30.32it/s]Training:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 450/610 [00:15<00:05, 30.70it/s]Training:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 454/610 [00:15<00:05, 30.98it/s]Training:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 458/610 [00:15<00:04, 31.10it/s]Training:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 462/610 [00:15<00:04, 31.29it/s]Training:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 466/610 [00:15<00:04, 31.42it/s]Training:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 470/610 [00:16<00:04, 31.57it/s]Training:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 474/610 [00:16<00:04, 31.68it/s]Training:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 478/610 [00:16<00:04, 31.70it/s]Training:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 482/610 [00:16<00:04, 31.67it/s]Training:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 486/610 [00:16<00:03, 31.70it/s]Training:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 490/610 [00:16<00:03, 31.63it/s]Training:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 494/610 [00:16<00:03, 31.64it/s]Training:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 498/610 [00:16<00:03, 31.68it/s]Training:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 502/610 [00:17<00:03, 31.78it/s]Training:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 506/610 [00:17<00:03, 31.72it/s]Training:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 510/610 [00:17<00:03, 31.66it/s]Training:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 514/610 [00:17<00:03, 31.69it/s]Training:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 518/610 [00:17<00:02, 31.71it/s]Training:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 522/610 [00:17<00:02, 31.72it/s]Training:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 526/610 [00:17<00:02, 31.65it/s]Training:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 530/610 [00:17<00:02, 31.47it/s]Training:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 534/610 [00:18<00:02, 31.43it/s]Training:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 538/610 [00:18<00:02, 31.50it/s]Training:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 542/610 [00:18<00:02, 31.37it/s]Training:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 546/610 [00:18<00:02, 31.27it/s]Training:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 550/610 [00:18<00:01, 31.30it/s]Training:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 554/610 [00:18<00:01, 31.34it/s]Training:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 558/610 [00:18<00:01, 31.30it/s]Training:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 562/610 [00:18<00:01, 31.26it/s]Training:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 566/610 [00:19<00:01, 31.28it/s]Training:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 570/610 [00:19<00:01, 31.43it/s]Training:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 574/610 [00:19<00:01, 31.51it/s]Training:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 578/610 [00:19<00:01, 31.54it/s]Training:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 582/610 [00:19<00:00, 31.59it/s]Training:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 586/610 [00:19<00:00, 31.52it/s]Training:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 590/610 [00:19<00:00, 31.53it/s]Training:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 594/610 [00:20<00:00, 31.61it/s]Training:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 598/610 [00:20<00:00, 31.70it/s]Training:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 602/610 [00:20<00:00, 31.71it/s]Training:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 606/610 [00:20<00:00, 31.60it/s]Training: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 610/610 [00:20<00:00, 31.67it/s]Saving checkpoint
Training: 611it [00:20, 29.38it/s]                         
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33msmollm2-sparsify-lmsys-2M-token-18-layers-16-expansion-64-k[0m at: [34mhttps://wandb.ai/tilmankerl-technical-university-of-vienna/sparsify/runs/7fadqj4n[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250618_001514-7fadqj4n/logs[0m
[rank0]:[W618 00:15:38.661022090 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
