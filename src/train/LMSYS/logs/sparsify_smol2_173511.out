W0617 11:29:57.880000 3436817 site-packages/torch/distributed/run.py:792] 
W0617 11:29:57.880000 3436817 site-packages/torch/distributed/run.py:792] *****************************************
W0617 11:29:57.880000 3436817 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0617 11:29:57.880000 3436817 site-packages/torch/distributed/run.py:792] *****************************************
Using DDP across 2 GPUs.
Map (num_proc=4):   0%|          | 0/777453 [00:00<?, ? examples/s]Map (num_proc=4):   0%|          | 2048/777453 [00:03<19:53, 649.42 examples/s]Map (num_proc=4):   1%|          | 4096/777453 [00:04<11:57, 1077.23 examples/s]Map (num_proc=4):   1%|          | 6144/777453 [00:04<06:51, 1872.92 examples/s]Map (num_proc=4):   1%|▏         | 10240/777453 [00:05<05:54, 2165.13 examples/s]Map (num_proc=4):   2%|▏         | 12288/777453 [00:07<06:11, 2059.96 examples/s]Map (num_proc=4):   2%|▏         | 14336/777453 [00:07<05:38, 2253.65 examples/s]Map (num_proc=4):   2%|▏         | 16384/777453 [00:07<04:12, 3015.64 examples/s]Map (num_proc=4):   2%|▏         | 18432/777453 [00:08<04:31, 2792.15 examples/s]Map (num_proc=4):   3%|▎         | 20480/777453 [00:10<06:58, 1807.47 examples/s]Map (num_proc=4):   3%|▎         | 22528/777453 [00:11<05:51, 2146.94 examples/s]Map (num_proc=4):   3%|▎         | 24576/777453 [00:11<04:18, 2909.89 examples/s]Map (num_proc=4):   4%|▎         | 28672/777453 [00:13<05:15, 2371.52 examples/s]Map (num_proc=4):   4%|▍         | 30720/777453 [00:14<05:01, 2475.22 examples/s]Map (num_proc=4):   4%|▍         | 32768/777453 [00:15<05:12, 2382.43 examples/s]Map (num_proc=4):   4%|▍         | 34816/777453 [00:16<06:00, 2059.11 examples/s]Map (num_proc=4):   5%|▍         | 36864/777453 [00:17<05:14, 2351.43 examples/s]Map (num_proc=4):   5%|▌         | 40960/777453 [00:19<05:32, 2214.79 examples/s]Map (num_proc=4):   6%|▌         | 43008/777453 [00:20<05:26, 2250.42 examples/s]Map (num_proc=4):   6%|▌         | 47104/777453 [00:22<05:57, 2043.31 examples/s]Map (num_proc=4):   6%|▋         | 49152/777453 [00:22<04:52, 2487.02 examples/s]Map (num_proc=4):   7%|▋         | 51200/777453 [00:22<04:02, 2991.87 examples/s]Map (num_proc=4):   7%|▋         | 53248/777453 [00:23<04:45, 2538.23 examples/s]Map (num_proc=4):   7%|▋         | 55296/777453 [00:25<05:29, 2194.66 examples/s]Map (num_proc=4):   7%|▋         | 57344/777453 [00:25<04:43, 2538.43 examples/s]Map (num_proc=4):   8%|▊         | 59392/777453 [00:25<03:46, 3165.78 examples/s]Map (num_proc=4):   8%|▊         | 61440/777453 [00:27<05:23, 2213.93 examples/s]Map (num_proc=4):   8%|▊         | 63488/777453 [00:28<04:35, 2590.85 examples/s]Map (num_proc=4):   8%|▊         | 65536/777453 [00:28<04:17, 2768.34 examples/s]Map (num_proc=4):   9%|▊         | 67584/777453 [00:28<03:13, 3675.98 examples/s]Map (num_proc=4):   9%|▉         | 69632/777453 [00:30<05:36, 2101.82 examples/s]Map (num_proc=4):   9%|▉         | 71680/777453 [00:31<05:17, 2220.08 examples/s]Map (num_proc=4):  10%|▉         | 75776/777453 [00:31<03:15, 3589.77 examples/s]Map (num_proc=4):  10%|█         | 77824/777453 [00:34<05:53, 1976.96 examples/s]Map (num_proc=4):  10%|█         | 79872/777453 [00:34<04:30, 2575.62 examples/s]Map (num_proc=4):  11%|█         | 83968/777453 [00:35<03:55, 2944.82 examples/s]Map (num_proc=4):  11%|█         | 86016/777453 [00:37<05:26, 2120.03 examples/s]Map (num_proc=4):  11%|█▏        | 88064/777453 [00:37<04:39, 2466.34 examples/s]Map (num_proc=4):  12%|█▏        | 92160/777453 [00:39<04:33, 2503.25 examples/s]Map (num_proc=4):  12%|█▏        | 94208/777453 [00:40<04:28, 2545.90 examples/s]Map (num_proc=4):  12%|█▏        | 96256/777453 [00:40<03:54, 2911.08 examples/s]Map (num_proc=4):  13%|█▎        | 98304/777453 [00:41<04:11, 2702.27 examples/s]Map (num_proc=4):  13%|█▎        | 100352/777453 [00:42<05:12, 2166.09 examples/s]Map (num_proc=4):  13%|█▎        | 104448/777453 [00:43<03:18, 3382.81 examples/s]Map (num_proc=4):  14%|█▎        | 106496/777453 [00:45<05:06, 2192.24 examples/s]Map (num_proc=4):  14%|█▍        | 108544/777453 [00:45<04:45, 2344.41 examples/s]Map (num_proc=4):  14%|█▍        | 110592/777453 [00:46<04:07, 2693.96 examples/s]Map (num_proc=4):  14%|█▍        | 112640/777453 [00:46<03:35, 3077.94 examples/s]Map (num_proc=4):  15%|█▍        | 114688/777453 [00:48<05:39, 1949.40 examples/s]Map (num_proc=4):  15%|█▌        | 116736/777453 [00:48<04:15, 2583.41 examples/s]Map (num_proc=4):  15%|█▌        | 118784/777453 [00:49<03:21, 3263.52 examples/s]Map (num_proc=4):  16%|█▌        | 120832/777453 [00:50<04:51, 2249.88 examples/s]Map (num_proc=4):  16%|█▌        | 122880/777453 [00:51<04:55, 2213.84 examples/s]Map (num_proc=4):  16%|█▌        | 124928/777453 [00:52<04:01, 2705.84 examples/s]Map (num_proc=4):  16%|█▋        | 126976/777453 [00:52<03:29, 3105.82 examples/s]Map (num_proc=4):  17%|█▋        | 129024/777453 [00:55<07:22, 1463.79 examples/s]Map (num_proc=4):  17%|█▋        | 131072/777453 [00:55<05:29, 1960.73 examples/s]Map (num_proc=4):  17%|█▋        | 133120/777453 [00:56<04:33, 2352.46 examples/s]Map (num_proc=4):  17%|█▋        | 135168/777453 [00:56<03:27, 3100.29 examples/s]Map (num_proc=4):  18%|█▊        | 137216/777453 [00:59<07:21, 1448.65 examples/s]Map (num_proc=4):  18%|█▊        | 139264/777453 [00:59<05:21, 1983.20 examples/s]Map (num_proc=4):  18%|█▊        | 141312/777453 [01:00<04:12, 2522.88 examples/s]Map (num_proc=4):  18%|█▊        | 143360/777453 [01:00<03:14, 3267.45 examples/s]Map (num_proc=4):  19%|█▊        | 145408/777453 [01:03<07:22, 1428.90 examples/s]Map (num_proc=4):  19%|█▉        | 149504/777453 [01:03<04:18, 2427.47 examples/s]Map (num_proc=4):  19%|█▉        | 151552/777453 [01:04<03:28, 3000.92 examples/s]Map (num_proc=4):  20%|█▉        | 153600/777453 [01:07<06:59, 1486.96 examples/s]Map (num_proc=4):  20%|██        | 157696/777453 [01:07<04:12, 2450.16 examples/s]Map (num_proc=4):  21%|██        | 159744/777453 [01:08<04:12, 2451.01 examples/s]Map (num_proc=4):  21%|██        | 161792/777453 [01:10<05:27, 1878.54 examples/s]Map (num_proc=4):  21%|██▏       | 165888/777453 [01:11<04:09, 2446.94 examples/s]Map (num_proc=4):  22%|██▏       | 167936/777453 [01:12<04:45, 2137.50 examples/s]Map (num_proc=4):  22%|██▏       | 169984/777453 [01:14<05:34, 1818.39 examples/s]Map (num_proc=4):  22%|██▏       | 174080/777453 [01:15<04:19, 2322.70 examples/s]Map (num_proc=4):  23%|██▎       | 176128/777453 [01:16<04:28, 2235.90 examples/s]Map (num_proc=4):  23%|██▎       | 178176/777453 [01:18<06:03, 1649.58 examples/s]Map (num_proc=4):  23%|██▎       | 182272/777453 [01:19<04:02, 2450.74 examples/s]Map (num_proc=4):  24%|██▎       | 184320/777453 [01:20<04:15, 2320.89 examples/s]Map (num_proc=4):  24%|██▍       | 186368/777453 [01:21<04:35, 2141.83 examples/s]Map (num_proc=4):  24%|██▍       | 188416/777453 [01:21<03:52, 2536.32 examples/s]Map (num_proc=4):  24%|██▍       | 190464/777453 [01:22<03:40, 2660.40 examples/s]Map (num_proc=4):  25%|██▍       | 192512/777453 [01:24<05:07, 1902.85 examples/s]Map (num_proc=4):  25%|██▌       | 194560/777453 [01:24<04:13, 2301.53 examples/s]Map (num_proc=4):  26%|██▌       | 198656/777453 [01:25<03:21, 2878.68 examples/s]Map (num_proc=4):  26%|██▌       | 200704/777453 [01:27<04:41, 2052.19 examples/s]Map (num_proc=4):  26%|██▋       | 204800/777453 [01:27<02:52, 3314.18 examples/s]Map (num_proc=4):  27%|██▋       | 206848/777453 [01:29<04:12, 2256.64 examples/s]Map (num_proc=4):  27%|██▋       | 208896/777453 [01:30<04:04, 2328.14 examples/s]Map (num_proc=4):  27%|██▋       | 212992/777453 [01:31<03:32, 2657.55 examples/s]Map (num_proc=4):  28%|██▊       | 215040/777453 [01:33<04:15, 2204.96 examples/s]Map (num_proc=4):  28%|██▊       | 219136/777453 [01:33<02:53, 3225.68 examples/s]Map (num_proc=4):  28%|██▊       | 221184/777453 [01:35<04:17, 2156.60 examples/s]Map (num_proc=4):  29%|██▊       | 223232/777453 [01:35<03:37, 2550.27 examples/s]Map (num_proc=4):  29%|██▉       | 225280/777453 [01:36<03:21, 2745.86 examples/s]Map (num_proc=4):  29%|██▉       | 227328/777453 [01:36<02:56, 3109.14 examples/s]Map (num_proc=4):  30%|██▉       | 229376/777453 [01:38<04:16, 2136.56 examples/s]Map (num_proc=4):  30%|██▉       | 231424/777453 [01:38<03:18, 2749.87 examples/s]Map (num_proc=4):  30%|███       | 233472/777453 [01:39<03:29, 2595.76 examples/s]Map (num_proc=4):  30%|███       | 235520/777453 [01:40<03:18, 2723.56 examples/s]Map (num_proc=4):  31%|███       | 237568/777453 [01:41<03:38, 2469.81 examples/s]Map (num_proc=4):  31%|███       | 239616/777453 [01:41<02:58, 3007.05 examples/s]Map (num_proc=4):  31%|███       | 241664/777453 [01:42<03:16, 2730.10 examples/s]Map (num_proc=4):  31%|███▏      | 243712/777453 [01:44<04:14, 2095.52 examples/s]Map (num_proc=4):  32%|███▏      | 247808/777453 [01:44<02:40, 3291.86 examples/s]Map (num_proc=4):  32%|███▏      | 249856/777453 [01:45<03:00, 2928.44 examples/s]Map (num_proc=4):  32%|███▏      | 251904/777453 [01:46<03:48, 2303.93 examples/s]Map (num_proc=4):  33%|███▎      | 253952/777453 [01:47<03:40, 2371.35 examples/s]Map (num_proc=4):  33%|███▎      | 256000/777453 [01:48<03:20, 2604.22 examples/s]Map (num_proc=4):  33%|███▎      | 258048/777453 [01:48<02:32, 3412.79 examples/s]Map (num_proc=4):  33%|███▎      | 260096/777453 [01:49<03:17, 2622.55 examples/s]Map (num_proc=4):  34%|███▎      | 262144/777453 [01:50<03:20, 2565.42 examples/s]Map (num_proc=4):  34%|███▍      | 264192/777453 [01:51<03:36, 2366.52 examples/s]Map (num_proc=4):  34%|███▍      | 266240/777453 [01:52<03:13, 2645.95 examples/s]Map (num_proc=4):  35%|███▍      | 268288/777453 [01:53<03:49, 2214.17 examples/s]Map (num_proc=4):  35%|███▌      | 272384/777453 [01:54<02:46, 3033.63 examples/s]Map (num_proc=4):  35%|███▌      | 274432/777453 [01:55<03:09, 2659.87 examples/s]Map (num_proc=4):  36%|███▌      | 276480/777453 [01:56<03:24, 2446.19 examples/s]Map (num_proc=4):  36%|███▌      | 278528/777453 [01:56<03:14, 2559.35 examples/s]Map (num_proc=4):  36%|███▌      | 280576/777453 [01:57<02:39, 3109.50 examples/s]Map (num_proc=4):  36%|███▋      | 282624/777453 [01:57<02:41, 3067.09 examples/s]Map (num_proc=4):  37%|███▋      | 284672/777453 [01:59<03:43, 2202.19 examples/s]Map (num_proc=4):  37%|███▋      | 286720/777453 [02:00<03:27, 2361.04 examples/s]Map (num_proc=4):  37%|███▋      | 288768/777453 [02:00<03:12, 2536.04 examples/s]Map (num_proc=4):  37%|███▋      | 290816/777453 [02:02<03:52, 2092.90 examples/s]Map (num_proc=4):  38%|███▊      | 292864/777453 [02:03<03:30, 2297.38 examples/s]Map (num_proc=4):  38%|███▊      | 294912/777453 [02:04<03:39, 2194.29 examples/s]Map (num_proc=4):  38%|███▊      | 296960/777453 [02:04<03:18, 2417.25 examples/s]Map (num_proc=4):  38%|███▊      | 299008/777453 [02:05<03:28, 2296.13 examples/s]Map (num_proc=4):  39%|███▊      | 301056/777453 [02:05<02:33, 3108.63 examples/s]Map (num_proc=4):  39%|███▉      | 303104/777453 [02:07<03:14, 2440.62 examples/s]Map (num_proc=4):  39%|███▉      | 305152/777453 [02:08<03:54, 2013.46 examples/s]Map (num_proc=4):  40%|███▉      | 307200/777453 [02:09<03:19, 2362.26 examples/s]Map (num_proc=4):  40%|███▉      | 309248/777453 [02:09<03:26, 2262.41 examples/s]Map (num_proc=4):  40%|████      | 311296/777453 [02:11<03:52, 2005.86 examples/s]Map (num_proc=4):  40%|████      | 313344/777453 [02:12<04:27, 1734.64 examples/s]Map (num_proc=4):  41%|████      | 315392/777453 [02:12<03:13, 2384.34 examples/s]Map (num_proc=4):  41%|████      | 317440/777453 [02:13<02:51, 2676.25 examples/s]Map (num_proc=4):  41%|████      | 319488/777453 [02:15<04:04, 1875.41 examples/s]Map (num_proc=4):  41%|████▏     | 321536/777453 [02:15<03:20, 2276.16 examples/s]Map (num_proc=4):  42%|████▏     | 323584/777453 [02:16<03:00, 2508.16 examples/s]Map (num_proc=4):  42%|████▏     | 325632/777453 [02:16<02:18, 3267.38 examples/s]Map (num_proc=4):  42%|████▏     | 327680/777453 [02:18<03:17, 2275.75 examples/s]Map (num_proc=4):  42%|████▏     | 329728/777453 [02:19<03:20, 2232.92 examples/s]Map (num_proc=4):  43%|████▎     | 333824/777453 [02:20<02:48, 2637.67 examples/s]Map (num_proc=4):  43%|████▎     | 335872/777453 [02:20<02:35, 2840.46 examples/s]Map (num_proc=4):  43%|████▎     | 337920/777453 [02:21<02:50, 2573.00 examples/s]Map (num_proc=4):  44%|████▎     | 339968/777453 [02:23<03:17, 2219.94 examples/s]Map (num_proc=4):  44%|████▍     | 344064/777453 [02:23<02:15, 3209.70 examples/s]Map (num_proc=4):  45%|████▍     | 346112/777453 [02:24<02:33, 2812.06 examples/s]Map (num_proc=4):  45%|████▍     | 348160/777453 [02:26<03:16, 2188.63 examples/s]Map (num_proc=4):  45%|████▌     | 350208/777453 [02:26<02:36, 2736.59 examples/s]Map (num_proc=4):  45%|████▌     | 352256/777453 [02:27<02:24, 2947.31 examples/s]Map (num_proc=4):  46%|████▌     | 354304/777453 [02:27<02:22, 2965.77 examples/s]Map (num_proc=4):  46%|████▌     | 356352/777453 [02:29<03:28, 2017.88 examples/s]Map (num_proc=4):  46%|████▌     | 358400/777453 [02:30<03:25, 2043.00 examples/s]Map (num_proc=4):  46%|████▋     | 360448/777453 [02:30<02:49, 2459.58 examples/s]Map (num_proc=4):  47%|████▋     | 362496/777453 [02:31<02:11, 3147.13 examples/s]Map (num_proc=4):  47%|████▋     | 364544/777453 [02:32<02:48, 2454.84 examples/s]Map (num_proc=4):  47%|████▋     | 366592/777453 [02:33<03:11, 2150.38 examples/s]Map (num_proc=4):  47%|████▋     | 368640/777453 [02:33<02:27, 2768.12 examples/s]Map (num_proc=4):  48%|████▊     | 370688/777453 [02:35<03:04, 2204.56 examples/s]Map (num_proc=4):  48%|████▊     | 374784/777453 [02:36<02:43, 2467.30 examples/s]Map (num_proc=4):  48%|████▊     | 376832/777453 [02:36<02:12, 3032.95 examples/s]Map (num_proc=4):  49%|████▊     | 378880/777453 [02:38<02:41, 2464.17 examples/s]Map (num_proc=4):  49%|████▉     | 380928/777453 [02:38<02:17, 2891.31 examples/s]Map (num_proc=4):  49%|████▉     | 382976/777453 [02:40<03:14, 2028.58 examples/s]Map (num_proc=4):  50%|████▉     | 385024/777453 [02:41<02:57, 2215.39 examples/s]Map (num_proc=4):  50%|█████     | 389120/777453 [02:41<01:52, 3439.43 examples/s]Map (num_proc=4):  50%|█████     | 391168/777453 [02:44<03:24, 1885.45 examples/s]Map (num_proc=4):  51%|█████     | 395264/777453 [02:44<02:08, 2968.29 examples/s]Map (num_proc=4):  51%|█████▏    | 399360/777453 [02:46<02:46, 2265.47 examples/s]Map (num_proc=4):  52%|█████▏    | 401408/777453 [02:47<02:31, 2487.52 examples/s]Map (num_proc=4):  52%|█████▏    | 405504/777453 [02:48<02:22, 2604.86 examples/s]Map (num_proc=4):  52%|█████▏    | 407552/777453 [02:50<02:43, 2266.69 examples/s]Map (num_proc=4):  53%|█████▎    | 409600/777453 [02:50<02:13, 2745.45 examples/s]Map (num_proc=4):  53%|█████▎    | 411648/777453 [02:52<03:17, 1855.28 examples/s]Map (num_proc=4):  53%|█████▎    | 413696/777453 [02:52<02:45, 2200.53 examples/s]Map (num_proc=4):  53%|█████▎    | 415744/777453 [02:53<02:06, 2860.45 examples/s]Map (num_proc=4):  54%|█████▎    | 417792/777453 [02:53<01:44, 3448.32 examples/s]Map (num_proc=4):  54%|█████▍    | 419840/777453 [02:55<02:51, 2091.25 examples/s]Map (num_proc=4):  54%|█████▍    | 421888/777453 [02:55<02:25, 2444.90 examples/s]Map (num_proc=4):  55%|█████▍    | 423936/777453 [02:56<02:28, 2387.16 examples/s]Map (num_proc=4):  55%|█████▍    | 425984/777453 [02:57<01:59, 2929.91 examples/s]Map (num_proc=4):  55%|█████▌    | 428032/777453 [02:58<02:14, 2602.85 examples/s]Map (num_proc=4):  55%|█████▌    | 430080/777453 [02:58<02:04, 2779.75 examples/s]Map (num_proc=4):  56%|█████▌    | 432128/777453 [02:59<02:18, 2488.41 examples/s]Map (num_proc=4):  56%|█████▌    | 434176/777453 [03:00<02:18, 2477.80 examples/s]Map (num_proc=4):  56%|█████▌    | 436224/777453 [03:01<02:04, 2749.30 examples/s]Map (num_proc=4):  56%|█████▋    | 438272/777453 [03:01<01:55, 2943.68 examples/s]Map (num_proc=4):  57%|█████▋    | 440320/777453 [03:03<03:00, 1863.67 examples/s]Map (num_proc=4):  57%|█████▋    | 442368/777453 [03:03<02:15, 2480.86 examples/s]Map (num_proc=4):  57%|█████▋    | 444416/777453 [03:04<02:05, 2662.23 examples/s]Map (num_proc=4):  57%|█████▋    | 446464/777453 [03:04<01:43, 3185.95 examples/s]Map (num_proc=4):  58%|█████▊    | 448512/777453 [03:06<02:43, 2014.94 examples/s]Map (num_proc=4):  58%|█████▊    | 450560/777453 [03:07<02:25, 2252.46 examples/s]Map (num_proc=4):  58%|█████▊    | 454656/777453 [03:07<01:25, 3790.38 examples/s]Map (num_proc=4):  59%|█████▊    | 456704/777453 [03:09<02:10, 2457.92 examples/s]Map (num_proc=4):  59%|█████▉    | 458752/777453 [03:10<02:16, 2336.63 examples/s]Map (num_proc=4):  60%|█████▉    | 462848/777453 [03:11<01:57, 2680.03 examples/s]Map (num_proc=4):  60%|█████▉    | 464896/777453 [03:12<01:46, 2921.96 examples/s]Map (num_proc=4):  60%|██████    | 466944/777453 [03:13<02:24, 2142.61 examples/s]Map (num_proc=4):  60%|██████    | 468992/777453 [03:14<01:59, 2586.52 examples/s]Map (num_proc=4):  61%|██████    | 471040/777453 [03:14<01:54, 2674.95 examples/s]Map (num_proc=4):  61%|██████    | 473088/777453 [03:15<01:37, 3112.91 examples/s]Map (num_proc=4):  61%|██████    | 475136/777453 [03:16<02:10, 2321.27 examples/s]Map (num_proc=4):  61%|██████▏   | 477184/777453 [03:17<02:12, 2267.76 examples/s]Map (num_proc=4):  62%|██████▏   | 479232/777453 [03:18<01:50, 2696.20 examples/s]Map (num_proc=4):  62%|██████▏   | 483328/777453 [03:19<01:45, 2780.48 examples/s]Map (num_proc=4):  62%|██████▏   | 485376/777453 [03:20<01:48, 2691.77 examples/s]Map (num_proc=4):  63%|██████▎   | 487424/777453 [03:20<01:36, 3018.76 examples/s]Map (num_proc=4):  63%|██████▎   | 489472/777453 [03:22<01:57, 2442.20 examples/s]Map (num_proc=4):  63%|██████▎   | 491520/777453 [03:22<01:28, 3220.87 examples/s]Map (num_proc=4):  63%|██████▎   | 493568/777453 [03:23<02:15, 2091.38 examples/s]Map (num_proc=4):  64%|██████▎   | 495616/777453 [03:24<02:12, 2134.56 examples/s]Map (num_proc=4):  64%|██████▍   | 497664/777453 [03:25<01:40, 2772.78 examples/s]Map (num_proc=4):  64%|██████▍   | 499712/777453 [03:25<01:27, 3160.84 examples/s]Map (num_proc=4):  65%|██████▍   | 501760/777453 [03:27<02:22, 1934.04 examples/s]Map (num_proc=4):  65%|██████▍   | 503808/777453 [03:27<01:51, 2457.02 examples/s]Map (num_proc=4):  65%|██████▌   | 505856/777453 [03:28<01:33, 2896.74 examples/s]Map (num_proc=4):  65%|██████▌   | 507904/777453 [03:30<02:25, 1849.36 examples/s]Map (num_proc=4):  66%|██████▌   | 509952/777453 [03:30<01:57, 2270.93 examples/s]Map (num_proc=4):  66%|██████▌   | 512000/777453 [03:31<01:46, 2491.46 examples/s]Map (num_proc=4):  66%|██████▌   | 514048/777453 [03:33<02:44, 1600.99 examples/s]Map (num_proc=4):  66%|██████▋   | 516096/777453 [03:33<02:04, 2101.51 examples/s]Map (num_proc=4):  67%|██████▋   | 518144/777453 [03:34<01:38, 2621.17 examples/s]Map (num_proc=4):  67%|██████▋   | 520192/777453 [03:36<02:15, 1896.57 examples/s]Map (num_proc=4):  67%|██████▋   | 522240/777453 [03:36<02:08, 1978.91 examples/s]Map (num_proc=4):  68%|██████▊   | 526336/777453 [03:37<01:12, 3452.42 examples/s]Map (num_proc=4):  68%|██████▊   | 528384/777453 [03:39<02:09, 1923.21 examples/s]Map (num_proc=4):  68%|██████▊   | 530432/777453 [03:39<01:40, 2460.93 examples/s]Map (num_proc=4):  69%|██████▉   | 534528/777453 [03:40<01:01, 3932.72 examples/s]Map (num_proc=4):  69%|██████▉   | 536576/777453 [03:42<01:55, 2087.14 examples/s]Map (num_proc=4):  69%|██████▉   | 538624/777453 [03:42<01:29, 2681.23 examples/s]Map (num_proc=4):  70%|██████▉   | 540672/777453 [03:43<01:39, 2391.67 examples/s]Map (num_proc=4):  70%|██████▉   | 542720/777453 [03:44<01:26, 2716.78 examples/s]Map (num_proc=4):  70%|███████   | 544768/777453 [03:46<01:58, 1958.44 examples/s]Map (num_proc=4):  70%|███████   | 546816/777453 [03:47<01:57, 1961.04 examples/s]Map (num_proc=4):  71%|███████   | 548864/777453 [03:47<01:40, 2274.23 examples/s]Map (num_proc=4):  71%|███████   | 552960/777453 [03:48<01:24, 2669.95 examples/s]Map (num_proc=4):  71%|███████▏  | 555008/777453 [03:50<01:34, 2343.78 examples/s]Map (num_proc=4):  72%|███████▏  | 557056/777453 [03:50<01:19, 2764.92 examples/s]Map (num_proc=4):  72%|███████▏  | 559104/777453 [03:51<01:27, 2484.39 examples/s]Map (num_proc=4):  72%|███████▏  | 561152/777453 [03:51<01:06, 3263.52 examples/s]Map (num_proc=4):  72%|███████▏  | 563200/777453 [03:52<01:28, 2431.18 examples/s]Map (num_proc=4):  73%|███████▎  | 565248/777453 [03:53<01:17, 2751.01 examples/s]Map (num_proc=4):  73%|███████▎  | 567296/777453 [03:54<01:27, 2408.90 examples/s]Map (num_proc=4):  73%|███████▎  | 569344/777453 [03:55<01:21, 2568.65 examples/s]Map (num_proc=4):  73%|███████▎  | 571392/777453 [03:55<01:11, 2870.59 examples/s]Map (num_proc=4):  74%|███████▍  | 573440/777453 [03:56<01:22, 2478.78 examples/s]Map (num_proc=4):  74%|███████▍  | 575488/777453 [03:57<01:14, 2694.44 examples/s]Map (num_proc=4):  74%|███████▍  | 577536/777453 [03:58<01:22, 2435.27 examples/s]Map (num_proc=4):  75%|███████▍  | 579584/777453 [03:59<01:34, 2100.10 examples/s]Map (num_proc=4):  75%|███████▍  | 581632/777453 [03:59<01:08, 2852.91 examples/s]Map (num_proc=4):  75%|███████▌  | 583680/777453 [04:00<00:55, 3500.24 examples/s]Map (num_proc=4):  75%|███████▌  | 585728/777453 [04:01<01:09, 2768.37 examples/s]Map (num_proc=4):  76%|███████▌  | 587776/777453 [04:02<01:25, 2230.18 examples/s]Map (num_proc=4):  76%|███████▌  | 589824/777453 [04:03<01:10, 2648.08 examples/s]Map (num_proc=4):  76%|███████▌  | 591872/777453 [04:03<01:08, 2704.88 examples/s]Map (num_proc=4):  76%|███████▋  | 593920/777453 [04:04<01:00, 3028.18 examples/s]Map (num_proc=4):  77%|███████▋  | 595968/777453 [04:05<01:11, 2555.22 examples/s]Map (num_proc=4):  77%|███████▋  | 598016/777453 [04:05<00:56, 3149.61 examples/s]Map (num_proc=4):  77%|███████▋  | 600064/777453 [04:06<01:14, 2375.34 examples/s]Map (num_proc=4):  77%|███████▋  | 602112/777453 [04:07<01:02, 2791.52 examples/s]Map (num_proc=4):  78%|███████▊  | 604160/777453 [04:08<01:04, 2685.64 examples/s]Map (num_proc=4):  78%|███████▊  | 606208/777453 [04:08<00:51, 3314.01 examples/s]Map (num_proc=4):  78%|███████▊  | 608256/777453 [04:09<01:09, 2435.99 examples/s]Map (num_proc=4):  79%|███████▊  | 610304/777453 [04:10<01:02, 2653.46 examples/s]Map (num_proc=4):  79%|███████▉  | 612352/777453 [04:11<01:04, 2575.24 examples/s]Map (num_proc=4):  79%|███████▉  | 614400/777453 [04:12<01:04, 2529.41 examples/s]Map (num_proc=4):  79%|███████▉  | 616448/777453 [04:12<00:55, 2925.25 examples/s]Map (num_proc=4):  80%|███████▉  | 618496/777453 [04:13<01:05, 2429.45 examples/s]Map (num_proc=4):  80%|███████▉  | 620544/777453 [04:14<00:52, 2964.99 examples/s]Map (num_proc=4):  80%|████████  | 622592/777453 [04:15<01:04, 2398.23 examples/s]Map (num_proc=4):  80%|████████  | 624640/777453 [04:15<00:48, 3148.03 examples/s]Map (num_proc=4):  81%|████████  | 626688/777453 [04:16<01:05, 2314.89 examples/s]Map (num_proc=4):  81%|████████  | 628736/777453 [04:17<00:58, 2543.60 examples/s]Map (num_proc=4):  81%|████████  | 630784/777453 [04:18<00:55, 2631.60 examples/s]Map (num_proc=4):  82%|████████▏ | 634880/777453 [04:19<00:54, 2634.37 examples/s]Map (num_proc=4):  82%|████████▏ | 636928/777453 [04:20<00:55, 2547.04 examples/s]Map (num_proc=4):  82%|████████▏ | 638976/777453 [04:21<00:44, 3077.93 examples/s]Map (num_proc=4):  82%|████████▏ | 641024/777453 [04:21<00:48, 2841.89 examples/s]Map (num_proc=4):  83%|████████▎ | 643072/777453 [04:23<01:11, 1884.91 examples/s]Map (num_proc=4):  83%|████████▎ | 645120/777453 [04:24<00:52, 2498.00 examples/s]Map (num_proc=4):  83%|████████▎ | 647168/777453 [04:25<00:56, 2321.81 examples/s]Map (num_proc=4):  84%|████████▍ | 651264/777453 [04:26<00:53, 2355.65 examples/s]Map (num_proc=4):  84%|████████▍ | 653312/777453 [04:27<00:54, 2289.85 examples/s]Map (num_proc=4):  84%|████████▍ | 655360/777453 [04:27<00:42, 2891.31 examples/s]Map (num_proc=4):  85%|████████▍ | 657408/777453 [04:28<00:32, 3728.33 examples/s]Map (num_proc=4):  85%|████████▍ | 659456/777453 [04:29<00:47, 2507.53 examples/s]Map (num_proc=4):  85%|████████▌ | 661504/777453 [04:30<00:48, 2386.57 examples/s]Map (num_proc=4):  85%|████████▌ | 663552/777453 [04:30<00:37, 3062.40 examples/s]Map (num_proc=4):  86%|████████▌ | 665600/777453 [04:31<00:44, 2524.49 examples/s]Map (num_proc=4):  86%|████████▌ | 667648/777453 [04:32<00:40, 2727.97 examples/s]Map (num_proc=4):  86%|████████▌ | 669696/777453 [04:33<00:40, 2643.17 examples/s]Map (num_proc=4):  86%|████████▋ | 671744/777453 [04:35<00:55, 1900.11 examples/s]Map (num_proc=4):  87%|████████▋ | 673792/777453 [04:35<00:45, 2261.07 examples/s]Map (num_proc=4):  87%|████████▋ | 675840/777453 [04:36<00:36, 2764.26 examples/s]Map (num_proc=4):  87%|████████▋ | 677888/777453 [04:37<00:53, 1868.76 examples/s]Map (num_proc=4):  87%|████████▋ | 679936/777453 [04:38<00:46, 2078.30 examples/s]Map (num_proc=4):  88%|████████▊ | 681984/777453 [04:39<00:46, 2060.91 examples/s]Map (num_proc=4):  88%|████████▊ | 684032/777453 [04:40<00:38, 2448.40 examples/s]Map (num_proc=4):  88%|████████▊ | 686080/777453 [04:41<00:42, 2147.46 examples/s]Map (num_proc=4):  89%|████████▊ | 688128/777453 [04:41<00:30, 2892.36 examples/s]Map (num_proc=4):  89%|████████▉ | 690176/777453 [04:42<00:35, 2466.94 examples/s]Map (num_proc=4):  89%|████████▉ | 692224/777453 [04:43<00:38, 2198.97 examples/s]Map (num_proc=4):  89%|████████▉ | 694272/777453 [04:44<00:31, 2606.99 examples/s]Map (num_proc=4):  90%|████████▉ | 696320/777453 [04:44<00:23, 3426.20 examples/s]Map (num_proc=4):  90%|████████▉ | 698368/777453 [04:46<00:36, 2155.67 examples/s]Map (num_proc=4):  90%|█████████ | 700219/777453 [04:46<00:35, 2173.78 examples/s]Map (num_proc=4):  91%|█████████ | 704315/777453 [04:47<00:21, 3449.50 examples/s]Map (num_proc=4):  91%|█████████ | 706363/777453 [04:49<00:36, 1965.12 examples/s]Map (num_proc=4):  91%|█████████ | 708411/777453 [04:50<00:28, 2383.76 examples/s]Map (num_proc=4):  91%|█████████▏| 710459/777453 [04:50<00:24, 2704.53 examples/s]Map (num_proc=4):  92%|█████████▏| 712507/777453 [04:52<00:37, 1751.63 examples/s]Map (num_proc=4):  92%|█████████▏| 714555/777453 [04:53<00:27, 2272.51 examples/s]Map (num_proc=4):  92%|█████████▏| 716603/777453 [04:54<00:31, 1920.24 examples/s]Map (num_proc=4):  92%|█████████▏| 718651/777453 [04:55<00:29, 1995.65 examples/s]Map (num_proc=4):  93%|█████████▎| 720699/777453 [04:56<00:27, 2043.63 examples/s]Map (num_proc=4):  93%|█████████▎| 722551/777453 [04:57<00:31, 1743.76 examples/s]Map (num_proc=4):  93%|█████████▎| 724599/777453 [04:58<00:22, 2372.01 examples/s]Map (num_proc=4):  93%|█████████▎| 726647/777453 [05:00<00:31, 1620.61 examples/s]Map (num_proc=4):  94%|█████████▎| 728695/777453 [05:01<00:33, 1468.57 examples/s]Map (num_proc=4):  94%|█████████▍| 730743/777453 [05:03<00:35, 1305.22 examples/s]Map (num_proc=4):  94%|█████████▍| 732791/777453 [05:05<00:35, 1261.58 examples/s]Map (num_proc=4):  95%|█████████▍| 734839/777453 [05:07<00:36, 1176.04 examples/s]Map (num_proc=4):  95%|█████████▍| 736887/777453 [05:08<00:31, 1277.36 examples/s]Map (num_proc=4):  95%|█████████▌| 738935/777453 [05:11<00:33, 1138.19 examples/s]Map (num_proc=4):  95%|█████████▌| 740983/777453 [05:11<00:25, 1431.68 examples/s]Map (num_proc=4):  96%|█████████▌| 743031/777453 [05:14<00:31, 1108.02 examples/s]Map (num_proc=4):  96%|█████████▌| 745079/777453 [05:14<00:21, 1479.00 examples/s]Map (num_proc=4):  96%|█████████▌| 747127/777453 [05:17<00:25, 1205.76 examples/s]Map (num_proc=4):  96%|█████████▋| 749175/777453 [05:18<00:22, 1257.50 examples/s]Map (num_proc=4):  97%|█████████▋| 751223/777453 [05:20<00:19, 1338.71 examples/s]Map (num_proc=4):  97%|█████████▋| 753271/777453 [05:22<00:22, 1069.27 examples/s]Map (num_proc=4):  97%|█████████▋| 755319/777453 [05:23<00:15, 1417.29 examples/s]Map (num_proc=4):  97%|█████████▋| 757367/777453 [05:26<00:18, 1063.86 examples/s]Map (num_proc=4):  98%|█████████▊| 759218/777453 [05:29<00:20, 872.33 examples/s] Map (num_proc=4):  98%|█████████▊| 761266/777453 [05:33<00:23, 685.86 examples/s]Map (num_proc=4):  98%|█████████▊| 763314/777453 [05:37<00:22, 640.51 examples/s]Map (num_proc=4):  98%|█████████▊| 765362/777453 [05:41<00:20, 597.32 examples/s]Map (num_proc=4):  99%|█████████▊| 767410/777453 [05:45<00:17, 560.48 examples/s]Map (num_proc=4):  99%|█████████▉| 769458/777453 [05:49<00:14, 547.45 examples/s]Map (num_proc=4):  99%|█████████▉| 771506/777453 [05:53<00:11, 539.83 examples/s]Map (num_proc=4):  99%|█████████▉| 773554/777453 [05:57<00:07, 537.72 examples/s]Map (num_proc=4): 100%|█████████▉| 775602/777453 [06:01<00:03, 532.14 examples/s]Map (num_proc=4): 100%|██████████| 777453/777453 [06:04<00:00, 533.48 examples/s]Map (num_proc=4): 100%|██████████| 777453/777453 [06:04<00:00, 2130.75 examples/s]
Shuffling dataset with seed 42
[rank0]: Traceback (most recent call last):
[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 197, in <module>
[rank0]:     run()
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 163, in run
[rank0]:     model, dataset = load_artifacts(args, rank)
[rank0]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/sparsify/__main__.py", line 135, in load_artifacts
[rank0]:     dataset = dataset.select(range(limit))
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/fingerprint.py", line 482, in wrapper
[rank0]:     out = func(dataset, *args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 3949, in select
[rank0]:     return self._select_contiguous(start, length, new_fingerprint=new_fingerprint)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
[rank0]:     out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
[rank0]:                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/fingerprint.py", line 482, in wrapper
[rank0]:     out = func(dataset, *args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 4010, in _select_contiguous
[rank0]:     _check_valid_indices_value(start + length - 1, len(self))
[rank0]:   File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/datasets/arrow_dataset.py", line 659, in _check_valid_indices_value
[rank0]:     raise IndexError(f"Index {index} out of range for dataset of size {size}.")
[rank0]: IndexError: Index 7812499 out of range for dataset of size 6557946.
[rank0]:[W617 11:36:12.623574576 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0617 11:36:13.166000 3436817 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3436827 closing signal SIGTERM
E0617 11:36:13.485000 3436817 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 3436826) of binary: /home/tilman.kerl/miniconda3/envs/refusal/bin/python
Traceback (most recent call last):
  File "/home/tilman.kerl/miniconda3/envs/refusal/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tilman.kerl/miniconda3/envs/refusal/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
sparsify FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-06-17_11:36:13
  host      : avm-a100-qs-9.novalocal
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3436826)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
